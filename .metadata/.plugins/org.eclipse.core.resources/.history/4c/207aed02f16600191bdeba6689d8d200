package com.ta.core.actions;

import java.io.File;

import com.ta.core.BatchProcess;
import com.ta.core.BatchProcess.ItemAction;

public class ValidateZip implements BatchProcess.ItemAction, Action {
	private String[] archiveFormats;
	
	public ValidateZip(String[] archiveFormats){
		this.archiveFormats = archiveFormats;
	}
	
	@Override
	public boolean doAction(File item) {
    	if(item.isDirectory())
    		return BatchProcess.performActionInFile(item,this);
    	else if(BatchProcess.isAnAllowedArchive(item.getName(),archiveFormats)){
    		return BatchProcess.openArchive(item.getAbsolutePath());
    	}

    	return true;
	}

	@Override
	public void run() {
    	try{
    		File file = new File(sourceDir);
            if(performActionInFile(file,new ValidateZip(archiveFormats))){
            	System.out.println("All archives OK");
            	
            }
    	}
    	catch(Throwable t){
    		t.printStackTrace();
    		
    	}
		
	}

}
