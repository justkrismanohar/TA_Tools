package com.ta.sample.A2;

import java.io.File;

import com.ta.core.MarkingProcess;
import com.ta.core.BatchProcess;
import com.ta.core.BatchProcess.ItemAction;
import com.ta.sample.InsertHeader;

public class MarkA2 extends BatchProcess {
	
    public static void main(String[] args){
    	String outputDir = "C:\\Users\\krism\\Projects\\Java\\COMP2603Marker\\output-test";
    	String markingSlipName = "Assignment_2_Makring_Slip.xlsx";
    	
        ItemAction markA1 = new ItemAction(){

			@Override
			public boolean doAction(File fileItem) {
				if(fileItem.isDirectory()){
					String filename = markingSlipName;
					MarkingProcess pm = new MarkingProcess(fileItem,filename,"A2");
					pm.addMarker(new InsertHeader(fileItem.getName(),"COMP 2603","Assignment #2"));
					pm.addMarker(new MarkA2TestCases());
					pm.markAll();
					pm.saveMarkingSlip();
					//should move files to a marked folder so don't accidentally overwrite them
				}
				return true;
			}
        	
        };
        
        performActionInFile(new File(outputDir), markA1);
        
        
    }
        
}
